# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
Архитектура проекта: 
MVP (Model-View-Presenter)

КЛЮЧЕВЫЕ ТИПЫ ДАННЫХ
Интерфейсы:

ICard - вся информация о товаре, хранящаяся в карточка
interface ICard {
    id: string;
    description: string;
    image: string;
    title: string;
    category: string;
    price: number | null;
}

IBasket - описывает содержимое корзины. Хранит элементы корзины в виде пар ключ-значение, где ключ - это идентификатор элемента (id), а значение - количество элементов в корзине. Включает метод: удаление товара из корзины, добавление товара, отображение общей стоимости

interface IBasket {
    items: Map<string, number>;
    totalprice: number;
    add(id: string): void;
    remove(id: string): void;
}

IForm - описывает интерфейс модальных окон

interface IForm {
    valid: boolean;
    errors: string[];
}

IFormPayment - описывает интерфейс модального окна, где пользователь указывает метод оплаты и адрес доставки

interface IFormPayment extends IForm {
    payment: PaymentMethod;
	address: string;
}

IFormContacts - описывает интерфес модального окна, где пользователь указывает свои контакты: телефон и электронную почту

interface IFormContacts extends IForm {
    email: string;
    phone: string;
}

IFormSuccess - описывает интерфейс модального окна, с информацией об удачной покупке и ее общей стоимости.

interface IFormSuccess extends IForm {
    totalprice: number;
}

IClientData - интерфейс данных клиента

interface IClientData extends IForm {
	payment: PaymentMethod;
	address: string;
	email: string;
	phone: string;
}

IEvents - описывает функционал для работы с событиями (events) и включает методы (по порядку соответственно):
1)  Метод для подписки на событие. Принимает имя события (event) и опциональные данные (data), которые будут переданы подписчикам этого события.
2) Метод для генерации события. Принимает имя события (event) и опциональные данные (data), которые будут переданы подписчикам этого события.
3) Метод для создания функции-обработчика события. Принимает имя события (event) и контекст (context), и возвращает функцию, которая будет вызвана при возникновении события.

interface IEvents {
    on<T extends object>(event: EventName, callback: (data: T) => void): void; 
    emit<T extends object>(event: string, data?: T): void;
    trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void;
}

ILarekAPI - интерфейс для работы с API

export interface ILarekAPI {
    getCardList: () => Promise<ICard[]>;
    getCard: (id: string) => Promise<ICard>;  
}

Классы:
class Api - базовый класс по подключению проекта. Имеет два поля baseUrl и options, которые инициализуются с помощью конструктора.
Включает методы:
handleResponse -  возвращает ответ сервера в формате JSON. При возникновении ошибки - обрабатывает ее. Данный метод вызывается из всех остальных методов;
get - принимает путь, возвращает информацию от сервера
post - принимает путь и данные для отправки на сервер, возвращает информацию от сервера;

class LarekAPI - реализация интерфейса ILarekAPI для работы с API, расширяет класс Api
Класс принимает на входе помимо указанных в базовом классе параметров, параметр cdn для путей изображений. baseUrl и options уходят в super();
Включает методы:
getCardList - получает массив карточек с сервера
getCard - получает конкретную карточку с сервера
postOrder - отправляет заказ на сервер


class EventEmitter - базовый класс по работе с событиями (брокер событий) на базе интерфейса IEvents. Имеет дополнительное поле events.
Включает методы:
on - установить обработчик на событие. Если события не существует, то создает его
off - удалить обработчик с события. Если обработчиков не существует, то удаляет событие
emit - инициировать событие с данными;
onAll - слушать все события;
offAll - удалить все события;
trigger - сделать коллбек триггер, генерирующий событие при вызове


class Component - абстрактный класс, который является базовым классом для создания UI компонентов. Он содержит методы, которые взаимодействуют с DOM элементами. 

Конструктор класса: принимает HTMLElement и инициализирует его.
Включает методы:
toggleClass - переключает класс;
setText - устаналивает текстовое содержимое;
setDisabled - меняет статус блокировки;
setHidden - скрывает элемент;
setVisible - делает видимым элемент;
setImage - устаналивает изображение с альтернативным текстом;
render - рендерит компонент


class Model - абстрактный класс, описывающий базовую модель, чтобы можно было ее отличить от простых объектов с данными. Конструктор базовой модели принимает данные и объект уведомлений об изменениях
Включает методы:
emitChanges - можно модифицировать состав данных перед отправкой


class Modal - основа для модальных окон. Конструктор принимает container и events. В контейнере ищет кнопку закрытия модального окна и контент.
Включает методы:
set content - установка или обновление контента
open - открытие модального окна
close - закрытие модального окна
render - отображение модального окна с данными

class Card - основа для карточек в каталоге. Принимает контейнер (HTMLElement). Поля класса включает поля интерфейcа ICard.
Включает методы:
setTitle - устанавливает название карточки
setImage - устаналивает изображение карточки
setCategory - устаналивает категорию карточки
setPrice - устаналивает стоимость товара карточка
setDescription - устанавливает описание карточки

class Form - основа для форм заказа. Конструктор принимает контейнер формы и объект событий. В классе ащищенные свойства _submit (кнопка отправки формы) и _errors (элемент для отображения ошибок).
Включает методы: 
onInputChange - вызывается при изменении значения в поле ввода и генерирует соответствующее событие.
set valid - проверяет состояние кнопки отправки
set errors - проверяет состояние отображения ошибок
render - обновляет состояние формы и отображает его

class Basket - основа для корзины с товарами. Конструктор принимает контейнер (HTMLElement) и объект событий.
Включает методы:
set items - устанавливает элементы в корзине. Если элементы есть, они заменяются в списке, иначе выводится сообщение о пустой корзине
set selected - правляет доступностью кнопки в зависимости от выбранных элементов
set total - устанавливает общую сумму покупок
